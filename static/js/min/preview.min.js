var sb=sb||{};$(function(){sb.rotator=function(d,c,a){var b=d3.dispatch("rotated","ringSizeUpdated");var e=0,f="scale(.125) translate(380, 670) ";b.update=function(j,h){$(d).empty();e=h||e;var g=d3.select(d);var l=g.append("svg:image").attr("id","previewImage").attr("x",0).attr("y",0).attr("width",313).attr("height",297).attr("xlink:href",b.getImage(j));var m=g.append("svg:g").attr("id","transform").attr("transform",b.getTransform(j));var k=$(c).clone().attr("class","mini-delaunay");$(m[0]).append(k);function i(n){e=(e+n)%360;m.attr("transform",b.getTransform(j))}$("#rotate-cw").click(function(){i(22.5)});$("#rotate-ccw").click(function(){i(-22.5)})};b.updateRing=function(){var g=$("#final-ring .frame").empty();var h=$(".ring-preview-frame").clone();$(g).append(h);b.ringSizeUpdated(7);var i=d3.scale.linear().domain([4,14]).range([0.8,1.2]);$("#ring-range").change(function(l){var j=l.currentTarget.value;$("#ring-number").text(j);b.ringSizeUpdated(j);var k=i(j);h.css({"-moz-transform":"rotateX(15deg) rotateY(0deg) rotateZ(45deg) translate3d(0px,0px,0px) scale("+k+")","-webkit-transform":"rotateX(15deg) rotateY(0deg) rotateZ(45deg) translate3d(0px,0px,0px) scale("+k+")"})})};b.getTransform=function(g){return sb.transforms.getTransform(g,"product",e)};b.getImage=function(g){return static_url+"images/preview/preview_"+g+".png"};b.rotation=function(g){if(!arguments.length){return e}e=g;return b};return b}("#rotate",".delaunay",".hidden")});