var sb=sb||{};sb.minimeshu=function(d,e){var h={},b=$(d).width()+"px",g=$(d).height()+"px",a=sb.map(d,b,g),e=e||"facet",i=sb.mesh[e](d,a,b,g);function c(j,k){i.add(j.latitude,j.longitude,k);h.updateBounds()}h.locations=function(j){var k={},m=[];for(var l=0;l<j.length;l++){var n=j[l];if(!k[n.name]){m.push({name:n.times&&n.times>1?n.name+" ("+n.times+")":n.name,latitude:+n.latitude,longitude:+n.longitude});k[n.name]=true}}i.locations(m)};function f(o){var j=o.split("|");var n=[],l={};for(var m=0;m<j.length;m++){var k=j[m].split("\t");if(k.length<3){continue}var p=k[0]+"-"+k[1];if(l[p]){continue}else{l[p]=true}n.push({latitude:parseFloat(k[0]),longitude:parseFloat(k[1]),name:k[2]})}return n}h.initializeFromData=function(m,l,k){i.prerender(k);var j=f(m);i.locations(j);if(l){i.applyStyle(l)}return h};h.mesh=function(){return i};h.updateBounds=function(j){a.updateBounds(i.lats(),i.lons(),j)};a.on("boundsUpdated",function(){if(i.updatePixelBounds){i.updatePixelBounds()}i.refresh()});i.on("locationsSet",function(){h.updateBounds(-0.2)});h.outputSVG=function(){return i.output()};h.outputLocationData=function(){var j=[];var l=i.places(),m=i.lats(),k=i.lons();$.each(l,function(o){var n=m[o]+"\t"+k[o]+"\t"+l[o];j.push(n)});return j.join("|")};return h};