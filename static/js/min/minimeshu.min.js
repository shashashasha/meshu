var sb=sb||{};sb.minimeshu=function(g,e){var c={},d=$(g).width()+"px",b=$(g).height()+"px",f=sb.map(g,d,b),e=e||"facet",h=sb.mesh[e](g,f,d,b);function a(i,j){h.add(i.latitude,i.longitude,j);c.updateBounds()}c.locations=function(j){var k={},m=[];for(var l=0;l<j.length;l++){var n=j[l];if(!k[n.name]){m.push({name:n.times&&n.times>1?n.name+" ("+n.times+")":n.name,latitude:+n.latitude,longitude:+n.longitude});k[n.name]=true}}h.locations(m)};c.locationData=function(o){var j=o.split("|");var n=[],l={};for(var m=0;m<j.length;m++){var k=j[m].split("\t");if(k.length<3){continue}var p=k[0]+"-"+k[1];if(l[p]){continue}else{l[p]=true}n.push({latitude:parseFloat(k[0]),longitude:parseFloat(k[1]),name:k[2]})}h.locations(n);return c};c.mesh=function(){return h};c.updateBounds=function(i){f.updateBounds(h.lats(),h.lons(),i)};f.on("boundsUpdated",function(){h.updatePixelBounds();h.refresh()});h.on("locationsSet",function(){c.updateBounds(-0.2)});c.outputSVG=function(){return h.output()};c.outputLocationData=function(){var i=[];var k=h.places(),l=h.lats(),j=h.lons();$.each(k,function(n){var m=l[n]+"\t"+j[n]+"\t"+k[n];i.push(m)});return i.join("|")};return c};