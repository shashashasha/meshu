$(function(){$("#shipping-destination li").click(function(){var d=$(this).attr("id").split("-").pop();var c=$("#shipping-destination");$("#shipping-form").attr("class",d);c.find("li").removeClass("active");$(this).addClass("active");cashier.shippingMode(d)});$("#coupon-code").submit(function(){var c=$("#coupon-code-value").val();cashier.applyCoupon(c,function(f){if(f.success){var g=parseFloat(f.amount);if(g<1&&g>0){var d=Math.round(cashier.getPrice()*(1-g));var e=Math.round((1-g)*100);$("<h2>").attr("id","subtotal-coupon").addClass("review-header").html("Coupon:<span>"+e+"% off! -$"+d+".00</span>").insertAfter("#subtotal-price")}else{if(g>1){$("<h2>").attr("id","subtotal-coupon").addClass("review-header").html("Coupon:<span>-$"+g+".00</span>").insertAfter("#subtotal-price")}}$("#coupon-message").fadeIn("fast").html(c+" discount applied!");$(".coupon-form").hide();$("#coupon").val(c)}else{$("#coupon-message").fadeIn("fast").html("Invalid code.")}self.updated()});return false});var b=$("#payment-form").validate({debug:true,rules:{card_number:{creditcard:true},card_cvc:{digits:true,minlength:3},card_month:{digits:true,minlength:2},card_year:{digits:true,minlength:4},email_address:{email:true}},messages:{shipping_state:"Please enter the two-letter state abbreviation.",card_cvc:"Sorry, that is not a valid CVC code",card_month:{minlength:"Please enter the month as a two-digit number."},card_year:{minlength:"Please enter the year as a four-digit number.",},},submitHandler:a});function a(c){cashier.submit();return false}return self});