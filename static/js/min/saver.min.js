var saver=function(){var a={};function d(){return{xhr:"true",title:a.meshu.outputTitle(),svg:a.meshu.outputSVG(),location_data:a.meshu.outputLocationData()}}function c(e){if(!e){return}if($("#meshu-id").length==0){$("#hidden-form-values").append('<input type="hidden" id="meshu-id" name="meshu_id" />')}$("#meshu-id").val(e)}function b(){var e=d();e.csrfmiddlewaretoken=$("#csrf input").val();if($("#meshu-id").length){e.id=parseInt($("#meshu-id").val())}$.post("/make/create/",e,function(f){c(f.meshu_id);if(a.postCreateCallback){a.postCreateCallback(f)}},"json")}a.initialize=function(f,e){a.meshu=f;$("#cancel-button").click(function(){window.location.href=e});$("#save-button").click(function(){if(!loadedMeshu){return}$("#save-button").html("saving");var g=loadedMeshu.edit_url+"save";$.get(g,d(),function(h){c(h.meshu_id);setTimeout(function(){$("#save-button").html("saved!")},200);setTimeout(function(){window.location.href=h.meshu_url},1000)},"json")});$("#update-button").click(function(){if(!loadedMeshu){return}$("#update-button").html("updating");var g=loadedMeshu.edit_url+"update";$.get(g,d(),function(h){c(h.meshu_id);setTimeout(function(){$("#update-button").html("saved!")},200);setTimeout(function(){window.location.href=h.meshu_url},1000)},"json")});return a};a.initializeNewMeshu=function(e){a.meshu=e;return a};a.createOrUpdateMeshu=function(e){if(a.meshu.isReadymade&&e){e()}else{b();if(e){a.postCreateCallback=e}}return a};a.getMeshuID=function(){return $("#meshu-id").val()};return a}();